# 🎙️ Whisper-to-Obsidian-to-Browser 시스템 가이드

음성 인식을 통해 **옵시디언(Obsidian)**에서 메모를 다듬고, 브라우저 입력창에 **자동으로 텍스트를 주입**하는 워크플로우 도구입니다.

---

## 🏗️ 전체 시스템 구조
1. **Python App**: 음성 녹음 + Whisper AI 인식 + 옵시디언 파일 생성 + 웹소켓 서버
2. **Browser Extension (Background)**: 브라우저 보안 정책을 우회하여 파이썬 서버와 통신 유지
3. **Browser Extension (Content)**: 입력창 클릭(Focus) 감지 및 텍스트 자동 삽입

---

## 🛠️ 사전 설정 (Setup)

### 1. 파이썬 환경 설정
* **필수 도구**: `ffmpeg`가 시스템에 설치되어 있어야 합니다.
* **경로 설정**: 스크립트 내 `OBSIDIAN_VAULT_PATH`를 실제 옵시디언 보관소 폴더 경로로 지정합니다.
* **전문 용어 사전 (`personal_dict.txt`)**:
    * 실행 파일과 같은 경로에 파일을 생성합니다.
    * 인식률을 높이고 싶은 고유명사나 전문 용어를 한 줄에 하나씩 입력합니다.
    * 예: `스마트X76`, `웨일랜드`, `위스퍼`, `옵시디언`

### 2. 브라우저 확장 프로그램 등록
* 브라우저의 확장 프로그램 관리자에서 '개발자 모드'를 활성화합니다.
* `manifest.json`이 포함된 폴더를 선택하여 '압축해제된 확장 프로그램'으로 로드합니다.

### 3. 브라우저 보안 정책 해제 (필수)
브라우저가 로컬 웹소켓(ws) 연결을 차단하지 않도록 아래 설정을 반드시 수행해야 합니다.

* **Firefox**: 
    * `about:config` 접속 -> `dom.security.https_only_mode_upgrade_local`을 `false`로 변경.
* **Chrome/Edge**: 
    * `chrome://flags/#allow-insecure-localhost` -> `Enabled`로 변경.
* **공통 (사이트별 설정)**:
    * 구글 등 보안 사이트 접속 시, 주소창 왼쪽 **[자물쇠]** 아이콘 클릭 -> **[사이트 설정]** -> **[안전하지 않은 콘텐츠]**를 **허용(Allow)**으로 변경.

---

## 🚀 사용 방법 (Workflow)

1. **시스템 가동**: 파이썬 앱을 실행하고 터미널에 `✅ 서버 연결 성공 (127.0.0.1:9999)`이 뜨는지 확인합니다.
2. **페이지 준비**: 텍스트를 입력할 웹페이지를 열고 **새로고침(F5)**을 1회 수행합니다.
3. **음성 녹음**: 파이썬 앱의 **[녹음 시작]**을 누르고 말을 한 뒤 **[중지]**를 누릅니다.
4. **메모 수정**: 자동으로 열린 **옵시디언** 파일에서 오타를 수정하고 저장(`Ctrl+S`)합니다.
5. **자동 입력**: 브라우저로 돌아가 입력창을 **'딸깍' 클릭(Focus)**하면 수정된 내용이 즉시 주입됩니다.

---

## 🔍 문제 해결 (FAQ)

* **Q: 클릭해도 반응이 없어요.**
    * 확장 프로그램 관리자에서 [다시 로드]를 누른 후, 해당 웹페이지를 반드시 **새로고침(F5)** 하세요.
* **Q: `wss` 관련 에러가 발생합니다.**
    * 브라우저가 보안 연결을 강제하는 경우입니다. `about:config` 또는 사이트별 '안전하지 않은 콘텐츠 허용' 설정을 다시 확인하세요.
* **Q: 텍스트가 한 번 들어간 뒤 또 들어갑니다.**
    * 파이썬 서버에서 전송 완료 후 파일 경로 변수(`last_filepath`)가 초기화되었는지 확인하세요.
